<!DOCTYPE html><html><head><meta content="IE=edge" http-equiv=X-UA-Compatible><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>[SQL][Ruby]SQLアンチパターン@Sendagaya.rb #141 | アペフチ</title><script src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script><link href="../../components/elements.vulcanized.html" rel=import /><link rel=alternate type="application/atom+xml" title="アペフチ" href="../../recent-days.atom"/><link href="../../bower_components/sanitize-css/sanitize.css" rel=stylesheet /><link href="../../stylesheets/highlight-81ca03d6.css" rel=stylesheet /><script src="../../javascripts/all-d7c52391.js"></script><link href="../../favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="../../images/favicon-8d71db77.png" rel=icon type="image/png" size=60x60 /><link href="/apehuci/manifest.json" rel=manifest><meta name=theme-color content="#b71c1c"><meta name=og:title content="[SQL][Ruby]SQLアンチパターン@Sendagaya.rb #141SQLアンチパターン@Sendagaya.rb #141"><meta name=twitter:description content="Sendagaya.rb #141で株式会社ランチェスターに行って来た。今回は『SQLアンチパターン』に関連して相談したいことがあるという参加者がいたので、その話を前半（というか殆ど）やって、後半は『メタプログラミングRuby』を読んだ。 SQLアンチパターン SQLアンチパターン著者 : Bill Karwinオライリージャパン発売日 : 2013-01-2..."><meta name=twitter:card content=summary><meta name=twitter:site content=@KitaitiMakoto><meta name=twitter:image content="https://kitaitimakoto.github.io/apehuci/images/icon-bbe8ac52.png"></head><body class="x2016 x2016_03 x2016_03_14"><blog-router base-regex="^/apehuci/"></blog-router><main><app-header-layout><app-header fixed shadow slot=header><app-toolbar><h2 class=site-title><a href="../../"> アペフチ <paper-ripple></paper-ripple></a></h2></app-toolbar></app-header><article><header><paper-card><h1>SQLアンチパターン@Sendagaya.rb #141</h1><time pubdate>2016-03-14</time><ul class=tags><li><a href="../../tags/sql.html" rel=tag>SQL</a></li><li><a href="../../tags/ruby.html" rel=tag>Ruby</a></li></ul></paper-card></header><paper-card><p><a href="https://sendagayarb.doorkeeper.jp/events/40813">Sendagaya.rb #141</a>で<a href="http://www.lanches.co.jp/">株式会社ランチェスター</a>に行って来た。今回は『<a href="https://www.oreilly.co.jp/books/9784873115894/">SQLアンチパターン</a>』に関連して相談したいことがあるという参加者がいたので、その話を前半（というか殆ど）やって、後半は『<a href="https://www.oreilly.co.jp/books/9784873117430/">メタプログラミングRuby</a>』を読んだ。</p><h2 id=sql>SQLアンチパターン</h2><div class=booklog_html><table><tr><td class=booklog_html_image><a href="http://www.amazon.co.jp/SQL%E3%82%A2%E3%83%B3%E3%83%81%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3-Bill-Karwin/dp/4873115892%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3Dbooklog.jp-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4873115892" target=_blank><img src="http://ecx.images-amazon.com/images/I/41qHKrFZi0L._SL160_.jpg" width=117 height=150 style="border:0;border-radius:0;"/></a></td><td class=booklog_html_info style="padding-left:20px;"><div class=booklog_html_title style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/SQL%E3%82%A2%E3%83%B3%E3%83%81%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3-Bill-Karwin/dp/4873115892%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3Dbooklog.jp-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4873115892" target=_blank>SQLアンチパターン</a></div><div style="margin-bottom:10px;"><div class=booklog_html_author style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/Bill+Karwin" target=_blank>Bill Karwin</a></div><div class=booklog_html_manufacturer style="margin-bottom:5px;font-size:12px;;line-height:1.2em">オライリージャパン</div><div class=booklog_html_release style="font-size:12px;;line-height:1.2em">発売日 : 2013-01-26</div></div><div class=booklog_html_link_amazon><a href="http://booklog.jp/item/1/4873115892" style="font-size:12px;" target=_blank>ブクログでレビューを見る»</a></div></td></tr></table></div><p>僕はこの本を持っていないから具体的なことはあまり分からないけれど、「ポリモーフィック関連はよくない」と言っている箇所があって、ちょうど自分で作っている物でもポリモーフィック関連を使っている所があって、それで相談に来たということらしかった。本の該当箇所を説明してもらったり、<a href="https://twitter.com/tkawa">@tkawa</a>さんが電子版を持っていたのでプロジェクターで映して見せてもらったりしながら話を聞いていると、基本的には外部キー制約が使えなくなることが問題のようで、これの解決方法として交差テーブル（だっけ？）という考え方と単一テーブル継承という考え方を紹介していた。</p><p>ポリモーフィック関連はよくない、しかしではどうしたらいいだろうか、この本で提示されている解決策もあまりいいようには思われない、ということで、その人の扱っている具体的なテーブル構造なんかを教えてもらいながらみんなでああだこうだと言っていた。一般的な正解がないタイプの問題だし、ウェブのサービスだと将来要件が変わることは容易に想像できる、それも今の段階ではどう変わるか想像できないタイプの変わり方をするものだから、正解を探すのはますます難しい。<a href="https://twitter.com/iR3">@iR3</a>さんが、長年の経験からためになるアドバイスをするなどしていた。<a href="http://fukajun.org/">fukajun</a>さんもいいこと言ったり、もっと言いたいことありそうだった（前にもテーブル設計の時に言いたいこと残してそうだったのを思い出すに、RDBMS得意そう）のだけど、残念ながら体調不良でidobataによるテキストチャットでの参加だったものだから、勿体無い感じなってしまった。勿体無い。</p><p>こういうのって、誰かに相談できる、話し相手がいることその物が価値だったりするものだなあという感覚を思い出した。</p><h2 id=ruby>メタプログラミングRuby</h2><p>最後三十分くらいで『メタプログラミングRuby 第2版』を読んだ。今回は主に<code class=highlighter-rouge>method_missing</code>の所だ。「<code class=highlighter-rouge>method_missing</code>を定義する時は一緒に<code class=highlighter-rouge>respond_to_missing?</code>も定義しましょう」というのがポイント。</p><p>あと、ついエイリアスメソッドチェインという言葉を使ってしまって「それ何？」って聞かれたのだけど、2016年なんだし、ほぼ説明を要するような言葉は封印していくべきだと感じた。</p><p>次回は<a href="http://rubyonrails.org/doctrine/">The Rails Doctrine</a>（多分、<a href="http://postd.cc/rails-doctrine/">日本語訳</a>のほう）を読みながらおしゃべりする予定：<br/><a href="https://sendagayarb.doorkeeper.jp/events/41208">https://sendagayarb.doorkeeper.jp/events/41208</a></p></paper-card><footer><ul><li class=next><a href="16.html" rel=next><paper-button raised>渋谷.rb[:20160316]</paper-button></a></li><li class=prev><a href="11.html" rel=prev><paper-button raised>Groongaの類似文書検索</paper-button></a></li></ul><paper-card><blog-search url="https://search.apehuci.kitaitimakoto.net/d" base=/apehuci/ table=Apehuci debounce-duration=300></blog-search></paper-card><paper-card> &copy; <a class=copy href="https://twitter.com/KitaitiMakoto">北市真</a></paper-card></footer></article></app-header-layout></main><script defer async src="//hypothes.is/embed.js"></script><script async="" src="//platform.twitter.com/widgets.js" charset=utf-8></script></body></html>